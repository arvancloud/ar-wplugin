(function(a){a.fn.extend({select2SortableOrder:function(){var b=this.filter("[multiple]");b.each(function(){var f=a(this);if(typeof(f.data("select2"))!=="object"){return false}var e=f.siblings(".select2-container");var d;var c=[];f.find("optgroup").each(function(g,h){c.push(h)});f.find("option").each(function(h,i){var j=a(this).parent("optgroup").prop("label");var g=this;if(j===undefined){if(this.value!==""&&!this.selected){c.push(g)}}});d=a(e.find('.select2-selection__rendered li[class!="select2-search__field"]').map(function(){if(!this){return undefined}if(a(this).data("data")!==undefined){var g=a(this).data("data").id;return f.find('option[value="'+g+'"]')[0]}}));d.push.apply(d,c);f.children().remove();f.append(d)});return b},select2Sortable:function(){var d=Array.prototype.slice.call(arguments,0);var f=this.filter("[multiple]");var e=["destroy"];if(d.length===0||typeof(d[0])==="object"){var b={bindOrder:"formSubmit",sortableOptions:{placeholder:"ui-state-highlight",items:"li:not(.select2-search__field)",tolerance:"pointer"}};var c=a.extend(b,d[0]);if(typeof(f.data("select2"))!=="object"){f.select2()}f.each(function(){var g=a(this);var h=g.siblings(".select2-container").find(".select2-selection__rendered");h.sortable(c.sortableOptions);switch(c.bindOrder){case"sortableStop":h.on("sortstop.select2sortable",function(i,j){g.select2SortableOrder()});g.on("change",function(i){a(this).select2SortableOrder()});break;default:g.closest("form").unbind("submit.select2sortable").on("submit.select2sortable",function(){g.select2SortableOrder()});break}})}else{if(typeof(d[0]==="string")){if(a.inArray(d[0],e)==-1){throw"Unknown method: "+d[0]}if(d[0]==="destroy"){f.select2SortableDestroy()}}}return f},select2SortableDestroy:function(){var b=this.filter("[multiple]");b.each(function(){var c=a(this);var d=c.parent().find(".select2-selection__rendered");c.closest("form").unbind("submit.select2sortable");d.unbind("sortstop.select2sortable");d.sortable("destroy")});return b}})}(jQuery));